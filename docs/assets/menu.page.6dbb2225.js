import{c as ve,o as be,h as y,a2 as Se,aA as $e,u as _e,r as q,a as C,x as le,w as qe,a9 as Te,d as xe,g as Ve,Q as B,s as me,a5 as H,a6 as ne,I as $,J as z,K as a,L as l,a7 as U,a8 as N,_ as D,T as S,ab as P,ad as R,ac as te,U as L,aB as ge,V as ae,aC as Ae,n as De,aD as Le,aE as G,i as Qe,aF as Ue,j as Ee}from"./index.c24c5156.js";import{u as Be,Q,a as Oe,c as je}from"./QInput.4145ff79.js";import{b as M,a as A,c as T,Q as fe}from"./QList.384a0411.js";import{Q as J}from"./QSeparator.98a2e7a2.js";import{b as ke,c as ye,u as Me,a as ze}from"./store.8a9fa305.js";import{u as Ne,a as Pe,b as Ke,Q as oe,_ as E,c as Re}from"./QDialog.b2a0fb82.js";import{Q as He}from"./QPage.9887f8a4.js";import{Q as he}from"./QBadge.e14b92a4.js";import{Q as Fe}from"./QChip.9f9ac0e7.js";import{a as ue,Q as ie}from"./QCard.d0cd7da1.js";import{Q as se,r as Ge}from"./QCardActions.5eb0d42b.js";import{d as pe}from"./dayjs.min.1c949302.js";import"./axios.f4c7f7be.js";import"./notify.7d033b23.js";import"./scroll.960bdccd.js";var Ye=ve({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:I,emit:t}){let v=!1,s,o,d=null,f=null,r,g;function p(){s&&s(),s=null,v=!1,d!==null&&(clearTimeout(d),d=null),f!==null&&(clearTimeout(f),f=null),o!==void 0&&o.removeEventListener("transitionend",r),r=null}function V(n,_,u){_!==void 0&&(n.style.height=`${_}px`),n.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,s=u}function x(n,_){n.style.overflowY=null,n.style.height=null,n.style.transition=null,p(),_!==g&&t(_)}function b(n,_){let u=0;o=n,v===!0?(p(),u=n.offsetHeight===n.scrollHeight?0:void 0):(g="hide",n.style.overflowY="hidden"),V(n,u,_),d=setTimeout(()=>{d=null,n.style.height=`${n.scrollHeight}px`,r=i=>{f=null,(Object(i)!==i||i.target===n)&&x(n,"show")},n.addEventListener("transitionend",r),f=setTimeout(r,e.duration*1.1)},100)}function w(n,_){let u;o=n,v===!0?p():(g="show",n.style.overflowY="hidden",u=n.scrollHeight),V(n,u,_),d=setTimeout(()=>{d=null,n.style.height=0,r=i=>{f=null,(Object(i)!==i||i.target===n)&&x(n,"hide")},n.addEventListener("transitionend",r),f=setTimeout(r,e.duration*1.1)},100)}return be(()=>{v===!0&&p()}),()=>y(Se,{css:!1,appear:e.appear,onEnter:b,onLeave:w},I.default)}});const K=$e({}),Je=Object.keys(_e);var Ze=ve({name:"QExpansionItem",props:{..._e,...Ne,...ke,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:{},headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...Pe,"click","afterShow","afterHide"],setup(e,{slots:I,emit:t}){const{proxy:{$q:v}}=Ve(),s=ye(e,v),o=q(e.modelValue!==null?e.modelValue:e.defaultOpened),d=q(null),f=Be(),{show:r,hide:g,toggle:p}=Ke({showing:o});let V,x;const b=C(()=>`q-expansion-item q-item-type q-expansion-item--${o.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),w=C(()=>{if(e.contentInsetLevel===void 0)return null;const m=v.lang.rtl===!0?"Right":"Left";return{["padding"+m]:e.contentInsetLevel*56+"px"}}),n=C(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),_=C(()=>{const m={};return Je.forEach(j=>{m[j]=e[j]}),m}),u=C(()=>n.value===!0||e.expandIconToggle!==!0),i=C(()=>e.expandedIcon!==void 0&&o.value===!0?e.expandedIcon:e.expandIcon||v.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),c=C(()=>e.disable!==!0&&(n.value===!0||e.expandIconToggle===!0)),k=C(()=>({expanded:o.value===!0,detailsId:f.value,toggle:p,show:r,hide:g})),F=C(()=>{const m=e.toggleAriaLabel!==void 0?e.toggleAriaLabel:v.lang.label[o.value===!0?"collapse":"expand"](e.label);return{role:"button","aria-expanded":o.value===!0?"true":"false","aria-controls":f.value,"aria-label":m}});le(()=>e.group,m=>{x!==void 0&&x(),m!==void 0&&W()});function de(m){n.value!==!0&&p(m),t("click",m)}function Y(m){m.keyCode===13&&Z(m,!0)}function Z(m,j){j!==!0&&d.value!==null&&d.value.focus(),p(m),me(m)}function re(){t("afterShow")}function ce(){t("afterHide")}function W(){V===void 0&&(V=Me()),o.value===!0&&(K[e.group]=V);const m=le(o,ee=>{ee===!0?K[e.group]=V:K[e.group]===V&&delete K[e.group]}),j=le(()=>K[e.group],(ee,we)=>{we===V&&ee!==void 0&&ee!==V&&g()});x=()=>{m(),j(),K[e.group]===V&&delete K[e.group],x=void 0}}function h(){const m={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},j=[y(B,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&o.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:i.value})];return c.value===!0&&(Object.assign(m,{tabindex:0,...F.value,onClick:Z,onKeyup:Y}),j.unshift(y("div",{ref:d,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),y(T,m,()=>j)}function O(){let m;return I.header!==void 0?m=[].concat(I.header(k.value)):(m=[y(T,()=>[y(A,{lines:e.labelLines},()=>e.label||""),e.caption?y(A,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&m[e.switchToggleSide===!0?"push":"unshift"](y(T,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>y(B,{name:e.icon})))),e.disable!==!0&&e.hideExpandIcon!==!0&&m[e.switchToggleSide===!0?"unshift":"push"](h()),m}function X(){const m={ref:"item",style:e.headerStyle,class:e.headerClass,dark:s.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return u.value===!0&&(m.clickable=!0,m.onClick=de,Object.assign(m,n.value===!0?_.value:F.value)),y(M,m,O)}function Ce(){return qe(y("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:w.value,id:f.value},xe(I.default)),[[Te,o.value]])}function Ie(){const m=[X(),y(Ye,{duration:e.duration,onShow:re,onHide:ce},Ce)];return e.expandSeparator===!0&&m.push(y(J,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:s.value}),y(J,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:s.value})),m}return e.group!==void 0&&W(),be(()=>{x!==void 0&&x()}),()=>y("div",{class:b.value},[y("div",{class:"q-expansion-item__container relative-position"},Ie())])}});const We={class:"q-px-md"},Xe={class:"q-gutter-y-xs column"},el={__name:"addIngredient.dialog.component",props:{modelValue:{},modelModifiers:{}},emits:H(["add"],["update:modelValue"]),setup(e,{emit:I}){const t=ne(e,"modelValue"),v=I,s=q({name:"",amount:{value:null,unit:""}}),o=()=>{t.value=!1,s.value.amount.value==""&&s.value.amount.unit==""&&(s.value.amount={value:null,unit:null}),v("add",E.cloneDeep(s.value))},d=()=>{s.value={name:"",amount:{value:null,unit:""}}};return(f,r)=>($(),z(oe,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=g=>t.value=g),position:"bottom",onHide:d},{default:a(()=>[l(ue,{style:{width:"350px"},class:"q-px-md"},{default:a(()=>[l(ie,null,{default:a(()=>[U("div",We,[U("div",Xe,[l(Q,{class:"text-body1",borderless:"",modelValue:s.value.name,"onUpdate:modelValue":r[0]||(r[0]=g=>s.value.name=g),dense:"",placeholder:"Title",autofocus:"",onKeyup:N(o,["enter"])},null,8,["modelValue"]),l(Q,{borderless:"",modelValue:s.value.amount.value,"onUpdate:modelValue":r[1]||(r[1]=g=>s.value.amount.value=g),dense:"",placeholder:"Value",onKeyup:N(o,["enter"])},{prepend:a(()=>[l(B,{size:"xs",name:"123"})]),_:1},8,["modelValue"]),l(Q,{borderless:"",modelValue:s.value.amount.unit,"onUpdate:modelValue":r[2]||(r[2]=g=>s.value.amount.unit=g),dense:"",placeholder:"Unit",onKeyup:N(o,["enter"])},{prepend:a(()=>[l(B,{size:"xs",name:"category"})]),_:1},8,["modelValue"])])])]),_:1}),l(se,{align:"right"},{default:a(()=>[l(D,{flat:"",color:"primary",disable:!s.value.name,onClick:o},{default:a(()=>[S("Add")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ll={class:"q-px-md"},tl={class:"q-gutter-y-xs column"},al={__name:"editIngredient.dialog.component",props:H({ingredient:Object},{modelValue:{},modelModifiers:{}}),emits:H(["save"],["update:modelValue"]),setup(e,{emit:I}){const t=ne(e,"modelValue"),v=e,s=I,o=q(E.cloneDeep(v.ingredient)),d=()=>{o.value={name:"",amount:{value:null,unit:""}}},f=()=>{t.value=!1,o.value.amount.value==""&&o.value.amount.unit==""&&(o.value.amount={value:null,unit:null}),s("save",E.cloneDeep(o.value))};return(r,g)=>($(),z(oe,{modelValue:t.value,"onUpdate:modelValue":g[3]||(g[3]=p=>t.value=p),position:"bottom",onHide:d},{default:a(()=>[l(ue,{style:{width:"350px"},class:"q-px-md"},{default:a(()=>[l(ie,null,{default:a(()=>[U("div",ll,[U("div",tl,[l(Q,{class:"text-body1",borderless:"",modelValue:o.value.name,"onUpdate:modelValue":g[0]||(g[0]=p=>o.value.name=p),dense:"",placeholder:"Title",autofocus:""},null,8,["modelValue"]),l(Q,{borderless:"",modelValue:o.value.amount.value,"onUpdate:modelValue":g[1]||(g[1]=p=>o.value.amount.value=p),dense:"",placeholder:"Value"},{prepend:a(()=>[l(B,{size:"xs",name:"123"})]),_:1},8,["modelValue"]),l(Q,{borderless:"",modelValue:o.value.amount.unit,"onUpdate:modelValue":g[2]||(g[2]=p=>o.value.amount.unit=p),dense:"",placeholder:"Unit"},{prepend:a(()=>[l(B,{size:"xs",name:"category"})]),_:1},8,["modelValue"])])])]),_:1}),l(se,{align:"right"},{default:a(()=>[l(D,{flat:"",color:"primary",disable:!o.value.name,onClick:f},{default:a(()=>[S("Save")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},nl={__name:"chooseIngredients.dialog.component",props:H({dishes:Array},{modelValue:{},modelModifiers:{}}),emits:H(["add"],["update:modelValue"]),setup(e,{emit:I}){pe.extend(Ge);const t=ne(e,"modelValue"),v=e,s=I,o=q(E.cloneDeep(v.dishes));q(null),q({show:!1});const d=q({show:!1,dish:null,ingredient:{}}),f=q({show:!1,dish:null,ingredient:null});le(()=>v.dishes,n=>{o.value=E.cloneDeep(n)});const r=()=>{const n=o.value.flatMap(_=>_.dish.ingredients);s("add",n),t.value=!1},g=n=>{d.value.dish=n,d.value.show=!0},p=n=>{d.value.dish.dish.ingredients.push(n)},V=(n,_,u)=>{f.value.dish=n,f.value.ingredient=_,f.value.show=!0},x=n=>{f.value.ingredient.name=n.name,f.value.ingredient.amount=n.amount},b=async(n,_)=>{n.dish.ingredients.splice(_,1)},w=n=>{n.due?n.due=n.due.add(1,"d"):n.due=pe().add(1,"d")};return(n,_)=>($(),P(R,null,[l(oe,{modelValue:t.value,"onUpdate:modelValue":_[0]||(_[0]=u=>t.value=u),position:"bottom"},{default:a(()=>[l(ue,{style:{width:"350px"},class:"q-pa-sm"},{default:a(()=>[l(ie,null,{default:a(()=>[l(fe,null,{default:a(()=>[($(!0),P(R,null,te(o.value,u=>($(),P(R,{key:u.dish._id},[l(A,{header:""},{default:a(()=>[S(L(u.dish.title)+" ("+L(u.amount)+" Portionen)",1)]),_:2},1024),($(!0),P(R,null,te(u.dish.ingredients,(i,c)=>($(),z(M,{key:c},{default:a(()=>[l(T,{side:"",top:""},{default:a(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",color:"negative",icon:"remove_circle_outline",onClick:ge(k=>b(u,c),["stop"])},null,8,["onClick"])]),_:2},1024),l(T,{clickable:"",onClick:k=>V(u,i)},{default:a(()=>[l(A,null,{default:a(()=>[S(L(i.name)+" ",1),i.subdish?($(),z(he,{key:0,class:"q-mx-sm",color:"secondary"},{default:a(()=>[S(L(i.subdish),1)]),_:2},1024)):ae("",!0),i.optional?($(),z(he,{key:1,class:"q-mx-sm"},{default:a(()=>[S("Optional")]),_:1})):ae("",!0),l(Fe,{removable:"",dense:"","model-value":!!i.due,onRemove:k=>i.due=null,class:"q-mx-sm",outline:"",color:"accent","text-color":"white"},{default:a(()=>[S(L(i.due.fromNow()),1)]),_:2},1032,["model-value","onRemove"])]),_:2},1024),l(A,{caption:""},{default:a(()=>[S(L(i.amount.value)+" "+L(i.amount.unit),1)]),_:2},1024)]),_:2},1032,["onClick"]),l(T,{side:""},{default:a(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",icon:"trending_flat",onClick:ge(k=>w(i),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(M,{clickable:"",onClick:i=>g(u)},{default:a(()=>[l(T,{side:"",top:""},{default:a(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",color:"primary",icon:"add_circle_outline"})]),_:1}),l(T,null,{default:a(()=>[l(A,null,{default:a(()=>[S("Add ingredient...")]),_:1})]),_:1})]),_:2},1032,["onClick"])],64))),128))]),_:1})]),_:1}),l(J,{inset:""}),l(se,{align:"right"},{default:a(()=>[l(D,{flat:"",color:"primary",label:"Add to list",onClick:r})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(el,{modelValue:d.value.show,"onUpdate:modelValue":_[1]||(_[1]=u=>d.value.show=u),onAdd:p},null,8,["modelValue"]),l(al,{modelValue:f.value.show,"onUpdate:modelValue":_[2]||(_[2]=u=>f.value.show=u),ingredient:f.value.ingredient,onSave:x},null,8,["modelValue","ingredient"])],64))}};function ol(e,I){const t=q(null),v=C(()=>e.disable===!0?null:y("span",{ref:t,class:"no-outline",tabindex:-1}));function s(o){const d=I.value;o!==void 0&&o.type.indexOf("key")===0?d!==null&&document.activeElement!==d&&d.contains(document.activeElement)===!0&&d.focus():t.value!==null&&(o===void 0||d!==null&&d.contains(o.target)===!0)&&t.value.focus()}return{refocusTargetEl:v,refocusTarget:s}}var ul={xs:30,sm:35,md:40,lg:50,xl:60};const il={...ke,...Le,...Oe,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>e==="tf"||e==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},sl=["update:modelValue"];function dl(e,I){const{props:t,slots:v,emit:s,proxy:o}=Ve(),{$q:d}=o,f=ye(t,d),r=q(null),{refocusTargetEl:g,refocusTarget:p}=ol(t,r),V=Ae(t,ul),x=C(()=>t.val!==void 0&&Array.isArray(t.modelValue)),b=C(()=>{const h=G(t.val);return x.value===!0?t.modelValue.findIndex(O=>G(O)===h):-1}),w=C(()=>x.value===!0?b.value!==-1:G(t.modelValue)===G(t.trueValue)),n=C(()=>x.value===!0?b.value===-1:G(t.modelValue)===G(t.falseValue)),_=C(()=>w.value===!1&&n.value===!1),u=C(()=>t.disable===!0?-1:t.tabindex||0),i=C(()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(t.disable===!0?" disabled":"")+(f.value===!0?` q-${e}--dark`:"")+(t.dense===!0?` q-${e}--dense`:"")+(t.leftLabel===!0?" reverse":"")),c=C(()=>{const h=w.value===!0?"truthy":n.value===!0?"falsy":"indet",O=t.color!==void 0&&(t.keepColor===!0||(e==="toggle"?w.value===!0:n.value!==!0))?` text-${t.color}`:"";return`q-${e}__inner relative-position non-selectable q-${e}__inner--${h}${O}`}),k=C(()=>{const h={type:"checkbox"};return t.name!==void 0&&Object.assign(h,{".checked":w.value,"^checked":w.value===!0?"checked":void 0,name:t.name,value:x.value===!0?t.val:t.trueValue}),h}),F=je(k),de=C(()=>{const h={tabindex:u.value,role:e==="toggle"?"switch":"checkbox","aria-label":t.label,"aria-checked":_.value===!0?"mixed":w.value===!0?"true":"false"};return t.disable===!0&&(h["aria-disabled"]="true"),h});function Y(h){h!==void 0&&(me(h),p(h)),t.disable!==!0&&s("update:modelValue",Z(),h)}function Z(){if(x.value===!0){if(w.value===!0){const h=t.modelValue.slice();return h.splice(b.value,1),h}return t.modelValue.concat([t.val])}if(w.value===!0){if(t.toggleOrder!=="ft"||t.toggleIndeterminate===!1)return t.falseValue}else if(n.value===!0){if(t.toggleOrder==="ft"||t.toggleIndeterminate===!1)return t.trueValue}else return t.toggleOrder!=="ft"?t.trueValue:t.falseValue;return t.indeterminateValue}function re(h){(h.keyCode===13||h.keyCode===32)&&me(h)}function ce(h){(h.keyCode===13||h.keyCode===32)&&Y(h)}const W=I(w,_);return Object.assign(o,{toggle:Y}),()=>{const h=W();t.disable!==!0&&F(h,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const O=[y("div",{class:c.value,style:V.value,"aria-hidden":"true"},h)];g.value!==null&&O.push(g.value);const X=t.label!==void 0?De(v.default,[t.label]):xe(v.default);return X!==void 0&&O.push(y("div",{class:`q-${e}__label q-anchor--skip`},X)),y("div",{ref:r,class:i.value,...de.value,onClick:Y,onKeydown:re,onKeyup:ce},O)}}var rl=ve({name:"QToggle",props:{...il,icon:String,iconColor:String},emits:sl,setup(e){function I(t,v){const s=C(()=>(t.value===!0?e.checkedIcon:v.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),o=C(()=>t.value===!0?e.iconColor:null);return()=>[y("div",{class:"q-toggle__track"}),y("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},s.value!==void 0?[y(B,{name:s.value,color:o.value})]:void 0)]}return dl("toggle",I)}});const cl={class:"row q-col-gutter-sm items-center"},ml={class:"col-6"},vl={class:"col-6"},fl={__name:"editDish.dialog.component",props:H({dish:Object},{modelValue:{},modelModifiers:{}}),emits:H(["save"],["update:modelValue"]),setup(e,{emit:I}){const t=ne(e,"modelValue"),v=e,s=I,o=q(E.cloneDeep(v.dish)),d=()=>{o.value=E.cloneDeep(v.dish)},f=()=>{o.value.ingredients.push({name:"",amount:{value:null,unit:""}})},r=V=>{o.value.ingredients.splice(V,1)},g=()=>{o.value={title:"",ingredients:[],standardAmount:0}},p=()=>{t.value=!1,o.value.ingredients.forEach(V=>{!V.amount&&!V.amount.unit&&(V.amount={value:null,unit:null})}),s("save",E.cloneDeep(o.value))};return(V,x)=>($(),z(oe,{modelValue:t.value,"onUpdate:modelValue":x[2]||(x[2]=b=>t.value=b),position:"bottom",onBeforeShow:d,onHide:g},{default:a(()=>[l(ue,{style:{width:"350px"}},{default:a(()=>[l(ie,null,{default:a(()=>[l(fe,null,{default:a(()=>[l(A,{header:""},{default:a(()=>[S("Name")]),_:1}),l(M,null,{default:a(()=>[l(Q,{class:"text-body1",borderless:"",modelValue:o.value.title,"onUpdate:modelValue":x[0]||(x[0]=b=>o.value.title=b),dense:"",placeholder:"Name",autofocus:"",onKeyup:N(p,["enter"])},null,8,["modelValue"])]),_:1}),l(A,{header:""},{default:a(()=>[S("Zutaten")]),_:1}),($(!0),P(R,null,te(o.value.ingredients,(b,w)=>($(),P(R,{key:w},[l(M,null,{default:a(()=>[l(T,{side:""},{default:a(()=>[l(D,{flat:"",dense:"",round:"",color:"negative",icon:"remove_circle_outline",size:"sm",onClick:n=>r(w)},null,8,["onClick"])]),_:2},1024),l(T,null,{default:a(()=>[l(A,null,{default:a(()=>[l(Q,{modelValue:b.name,"onUpdate:modelValue":n=>b.name=n,filled:"",dense:"",placeholder:"Title",autofocus:"",onKeyup:N(p,["enter"])},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(A,null,{default:a(()=>[U("div",cl,[U("div",ml,[l(Q,{modelValue:b.amount.value,"onUpdate:modelValue":n=>b.amount.value=n,filled:"",dense:"",onKeyup:N(p,["enter"])},{prepend:a(()=>[l(B,{size:"xs",name:"123"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),U("div",vl,[l(Q,{modelValue:b.amount.unit,"onUpdate:modelValue":n=>b.amount.unit=n,filled:"",dense:"",onKeyup:N(p,["enter"])},{prepend:a(()=>[l(B,{size:"xs",name:"category"})]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024),l(T,{side:""},{default:a(()=>[l(rl,{dense:"",modelValue:b.optional,"onUpdate:modelValue":n=>b.optional=n,icon:"low_priority",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),l(J,{inset:""})],64))),128)),l(M,{clickable:"",onClick:f},{default:a(()=>[l(T,{side:"",top:""},{default:a(()=>[l(D,{size:"12px",flat:"",dense:"",round:"",color:"primary",icon:"add_circle_outline"})]),_:1}),l(T,null,{default:a(()=>[l(A,null,{default:a(()=>[S("Add ingredient...")]),_:1})]),_:1})]),_:1}),l(A,{header:""},{default:a(()=>[S("\xDCbliche Menge")]),_:1}),l(M,null,{default:a(()=>[l(Q,{borderless:"",modelValue:o.value.standardAmount,"onUpdate:modelValue":x[1]||(x[1]=b=>o.value.standardAmount=b),dense:"",placeholder:"\xDCbliche Menge",autofocus:"",onKeyup:N(p,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(se,{align:"right"},{default:a(()=>{var b;return[l(D,{flat:"",color:"primary",disable:((b=o.value.ingredients)==null?void 0:b.length)==0,onClick:p},{default:a(()=>[S("Save")]),_:1},8,["disable"])]}),_:1})]),_:1})]),_:1},8,["modelValue"]))}},gl={class:"text-grey-8 q-gutter-xs flex items-center"},hl=U("span",{class:"text-bold"},"Zutaten pro Portion:",-1),pl={key:0,class:"q-mt-md"},bl=U("span",{class:"text-bold"},"Sub-dishes:",-1),Ql=Object.assign({name:"MenuPage"},{__name:"menu.page",setup(e){const I=Qe("notify"),t=Ue(),v=q(!0),s=q(""),o=q({show:!1,dishes:[]}),d=q({show:!1,dish:{}}),f=ze(),r=q([]),g=function(u){u.amount=u.amount==0?u.dish.standardAmount:u.amount+1,v.value=!1},p=function(u){u.amount-=1,v.value=E.sum(r.value.map(i=>i.amount))==0},V=()=>{o.value.dishes=E.cloneDeep(r.value.filter(u=>u.amount>0)),o.value.dishes.forEach(u=>{var i;u.dish.ingredients.forEach(c=>{c.amount.value=c.amount.unit!=null?c.amount.value*u.amount:c.amount.value}),(i=u.dish.subdishes)==null||i.forEach(c=>{c.dish=r.value.find(k=>k.dish.id==c.dish).dish,c.dish.ingredients.forEach(k=>{u.dish.ingredients.push({name:k.name,amount:{value:k.amount.value!=null?k.amount.value*u.amount*c.amountFactor:null,unit:k.amount.unit},optional:k.optional||c.optional,subdish:c.dish.title})})})}),o.value.show=!0},x=async u=>{await f.addToList(u)&&I("Ingredients added to list!",{actions:[{label:"Show",color:"white",handler:()=>{t.push("/list")}}]}),r.value.forEach(i=>i.amount=0),v.value=!0},b=u=>{d.value.dish=u,d.value.show=!0},w=async u=>{await f.editDish(u)&&I(`${u.title} edited!`)};Ee(async()=>{await f.fetchMenu(),r.value=f.menu.dishes.map(u=>({dish:u,amount:0})).sort((u,i)=>u.dish.title.localeCompare(i.dish.title))});const n=C(()=>s.value?r.value.filter(u=>JSON.stringify(u.dish).toLowerCase().includes(s.value.toLowerCase())):r.value),_=u=>u.amount.unit==null?u.name:u.amount.unit==""?`${u.amount.value} ${u.name}`:`${u.amount.value} ${u.amount.unit} ${u.name}`;return(u,i)=>($(),z(He,null,{default:a(()=>[r.value.length>0?($(),z(fe,{key:0,class:"q-pt-md"},{default:a(()=>[l(M,{class:"flex justify-center"},{default:a(()=>[l(Q,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=c=>s.value=c),standout:"",rounded:"",dense:"",clearable:"",placeholder:"Mmmmhhhes Schompf",style:{width:"60%","min-width":"300px"}},{prepend:a(()=>[l(B,{name:"search"})]),_:1},8,["modelValue"])]),_:1}),($(!0),P(R,null,te(n.value,c=>($(),z(Ze,{"expand-icon-toggle":"","switch-toggle-side":"",key:c.dish.id,"content-inset-level":1},{header:a(()=>[l(T,null,{default:a(()=>[l(A,null,{default:a(()=>[S(L(c.dish.title),1)]),_:2},1024),l(A,{caption:""},{default:a(()=>[S("\xDCbliche Menge: "+L(c.dish.standardAmount),1)]),_:2},1024)]),_:2},1024),l(T,{side:""},{default:a(()=>[U("div",gl,[l(D,{color:"red",disable:c.amount==0,flat:"",round:"",icon:"remove",onClick:k=>p(c)},null,8,["disable","onClick"]),U("span",null,L(c.amount),1),l(D,{color:"green",flat:"",round:"",icon:"add",onClick:k=>g(c)},null,8,["onClick"])])]),_:2},1024)]),default:a(()=>[l(M,null,{default:a(()=>[l(T,null,{default:a(()=>[U("div",null,[hl,S(" "+L(c.dish.ingredients.map(k=>_(k)).join(", ")),1)]),c.dish.subdishes&&c.dish.subdishes.length>0?($(),P("div",pl,[bl,S(" "+L(c.dish.subdishes.map(k=>`${r.value.find(F=>F.dish.id==k.dish).dish.title} (Menge: ${k.amountFactor})`).join(", ")),1)])):ae("",!0)]),_:2},1024),l(T,{side:""},{default:a(()=>[l(D,{flat:"",round:"",icon:"edit",onClick:k=>b(c.dish)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),l(J,{inset:""})]),_:2},1024))),128))]),_:1})):ae("",!0),l(Re,{position:"bottom",offset:[0,-28],style:{"z-index":"6000"}},{default:a(()=>[l(D,{fab:"",icon:"checklist",color:"accent",onClick:V,disabled:v.value},null,8,["disabled"])]),_:1}),l(nl,{"model-value":o.value.show,"onUpdate:modelValue":i[1]||(i[1]=c=>o.value.show=c),dishes:o.value.dishes,onAdd:x},null,8,["model-value","dishes"]),l(fl,{modelValue:d.value.show,"onUpdate:modelValue":i[2]||(i[2]=c=>d.value.show=c),dish:d.value.dish,onSave:w},null,8,["modelValue","dish"])]),_:1}))}});export{Ql as default};
